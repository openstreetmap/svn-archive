<?xml version="1.0"?>

<?include defines.wxi?>

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
   <Product  Id="132E9A8B-1BF6-4d55-893E-110D662FD355" Name="$(var.PackageName)" 
      Language="1033" Version="0.12.0.2" Manufacturer="Bart Vanhauwaert"
      UpgradeCode="4892C085-55A9-413b-9C7B-42E33ED7D7D2">

      <Package 
         Description="A map editor for OpenStreetMap.org (Debug version)" InstallerVersion="100" Compressed="yes" />

      <!--Set the icon for the msi and Add/Remove programs-->
      <Icon Id='Merkaartor.exe' SourceFile='..\Icons\Mercator_16x16.ico'/>
      <Property Id="ARPPRODUCTICON" Value="Merkaartor.exe" />
      <Property Id="ALLUSERS" Value="1"/>

      <Media Id="1" Cabinet="Product.cab" EmbedCab="yes" />
      
      <Directory Id="TARGETDIR" Name="SourceDir">
         <Directory Id="ProgramMenuFolder">
         </Directory>
         <Directory Id="ProgramFilesFolder">
            <Directory Id="INSTALLLOCATION" Name="Merkaartor">
                <Directory Id="MERKAARTORHARE" Name="share">
                   <Directory Id="WORLD_SHP" Name="world_shp" />
                </Directory>
                <Directory Id="QTIMAGEPLUGINDIR" Name="imageformats" />
                <Directory Id="QTTRANSLATIONS" Name="translations" />
            </Directory>
         </Directory>
      </Directory>

      <DirectoryRef Id="WORLD_SHP">
         <Component Id="World_shp" Guid="406fac4e-54cf-4901-b4b7-936f75a69e15">
            <File Id="world_adm0.dbf" Name="world_adm0.dbf"
               Source="$(var.SharePath)\world_shp\world_adm0.dbf" DiskId="1">
            </File>
            <File Id="world_adm0.shp" Name="world_adm0.shp"
               Source="$(var.SharePath)\world_shp\world_adm0.shp" DiskId="1">
            </File>
            <File Id="world_adm0.shx" Name="world_adm0.shx"
               Source="$(var.SharePath)\world_shp\world_adm0.shx" DiskId="1">
            </File>
         </Component>
      </DirectoryRef>

      <DirectoryRef Id="INSTALLLOCATION">
         <Component Id="DllCt" Guid="79C79986-ECB5-4835-9E98-4370C0F8B654">
            <File Id="mingwm10.dll" Name="mingwm10.dll"
               Source="$(var.MingwPath)\bin\mingwm10.dll" DiskId="1">
            </File>
            <File Id="libexslt.dll" Name="libexslt.dll"
               Source="$(var.DllPath)\libexslt.dll" DiskId="1">
            </File>
            <File Id="libxml2.dll" Name="libxml2.dll"
               Source="$(var.DllPath)\libxml2.dll" DiskId="1">
            </File>
            <File Id="libxslt.dll" Name="libxslt.dll"
               Source="$(var.DllPath)\libxslt.dll" DiskId="1">
            </File>
            <File Id="libproj.dll" Name="libproj.dll"
               Source="$(var.DllPath)\libproj.dll" DiskId="1">
            </File>
            <File Id="libgdal1.dll" Name="libgdal-1.dll"
               Source="$(var.DllPath)\libgdal-1.dll" DiskId="1">
            </File>
         </Component>
      </DirectoryRef>

      <DirectoryRef Id="INSTALLLOCATION">
         <Component Id="Merkaartor" Guid="5FDB24DB-CE92-433c-8AC4-288551C6AF7B">
	          <RegistryValue Root="HKCU" Key="Software\Merkaartor" Name="Installed" Type="integer" Value="1"/>
            <File Id="MerkaartorExe" Name="Merkaartor.exe"
               Source="$(var.BinPath)\Merkaartor.exe" DiskId="1">
               <Shortcut Id="myshort" Directory="ProgramMenuFolder"
                     Name="Merkaartor" WorkingDirectory="INSTALLLOCATION"/>
            </File>         
         </Component>
      </DirectoryRef>
 
      <DirectoryRef Id="QTTRANSLATIONS">
         <Component Id="MerkaartorTranslationsCt" Guid="8BA3BDF5-D15B-46e0-8581-2BF72A4B6940">
            <File Id="merkaartor_ar.qm" Name="merkaartor_ar.qm"
               Source="..\translations\merkaartor_ar.qm" DiskId="1">
            </File>
            <File Id="merkaartor_cs.qm" Name="merkaartor_cs.qm"
               Source="..\translations\merkaartor_cs.qm" DiskId="1">
            </File>
            <File Id="merkaartor_de.qm" Name="merkaartor_de.qm"
               Source="..\translations\merkaartor_de.qm" DiskId="1">
            </File>
            <File Id="merkaartor_es.qm" Name="merkaartor_es.qm"
               Source="..\translations\merkaartor_es.qm" DiskId="1">
            </File>
            <File Id="merkaartor_fr.qm" Name="merkaartor_fr.qm"
               Source="..\translations\merkaartor_fr.qm" DiskId="1">
            </File>
            <File Id="merkaartor_it.qm" Name="merkaartor_it.qm"
               Source="..\translations\merkaartor_it.qm" DiskId="1">
            </File>
            <File Id="merkaartor_ru.qm" Name="merkaartor_ru.qm"
               Source="..\translations\merkaartor_ru.qm" DiskId="1">
            </File>
            <File Id="merkaartor_pl.qm" Name="merkaartor_pl.qm"
               Source="..\translations\merkaartor_pl.qm" DiskId="1">
            </File>
         </Component>
      </DirectoryRef>
      
	  <Feature Id="MerkaartorFeature" Title="Merkaartor editor" Level="1"
         Display="expand" ConfigurableDirectory="INSTALLLOCATION">
         <ComponentRef Id="DllCt" />
         <ComponentRef Id="Merkaartor" />
      </Feature>
      <Feature Id="ftWorld_Shp" Title="World Shape file" Level="1"
         Display="expand" ConfigurableDirectory="WORLD_SHP">
         <ComponentRef Id="World_shp" />
      </Feature>
     <Feature Id="QtMainFeature" Title="Main Qt DLLs" Level="1"
        Display="expand" ConfigurableDirectory="INSTALLLOCATION">
       <ComponentRef Id="QtMain" />
     </Feature>
     <Feature Id="QtImagePluginsFeature" Title="Qt Image Plugins DLLs" Level="1"
        Display="expand" ConfigurableDirectory="QTIMAGEPLUGINDIR">
       <ComponentRef Id="QtImagePlugins" />
     </Feature>
     <Feature Id="TranslationsFeature" Title="Translation files" Level="1"
        Display="expand" ConfigurableDirectory="QTTRANSLATIONS">
       <ComponentRef Id="QtTranslations" />
       <ComponentRef Id="MerkaartorTranslationsCt" />
     </Feature>

     <UIRef Id="WixUI_Mondo"/>

   </Product>

   <?include qt.wxi?>
   <?include qttrans.wxi?>

</Wix>
